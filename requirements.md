# セキュリティチェックシート AI アプリ 要件仕様書

## 基本機能

-   セキュリティチェックシート AI アプリ
-   React + Vite + TypeScript（フロントエンド）
-   Express + TypeScript（バックエンド）
-   Docker + docker-compose で環境構築

------------------------------------------------------------------------

## フロントエンド要件

### UI フロー

1.  **出力用Excelファイルを指定**
    -   「出力用Excelファイルを指定」ボタンで Excel
        ファイルをアップロード
2.  **インプット情報ファイルを選択**
    -   「インプット情報ファイルを選択」ボタンで複数の資料ファイルをアップロード
3.  **質問入力**
    -   プロンプト入力用のテキストエリアを表示し、「送信」ボタンで質問を送信
4.  **回答表示**
    -   回答を画面に表示し、Excel に追記、ダウンロード可能にする

### UI デザイン

-   TailwindCSS を利用
-   アップロードボタンはカスタムデザイン（「ファイルを選択」ではなくラベル名で表示）
-   テキストエリアは横幅いっぱいに広げる
-   改行を反映して回答を表示
-   プロンプト送信中は「問い合わせ中...」を画面表示
-   追加で質問を繰り返しできる

### 表示形式

-   質問・回答をチャット風（吹き出し形式）で表示

------------------------------------------------------------------------

## バックエンド要件

### API

-   `/api/chat`
    -   アップロードされたインプット資料をテキスト化
    -   既存の Excel ファイルを読み込み、「質問」「回答」欄があれば追記\
    -   なければ新規シートを作成して「質問」「回答」列を追加
    -   ChatGPT API（`gpt-5-mini`）に質問と資料を渡し回答を取得
    -   回答を Excel に追記して保存
    -   保存後の Excel のダウンロード URL を返す

### ファイル管理

-   `uploads/` フォルダに一時ファイルを保存（リクエストごとに削除）
-   `downloads/` フォルダに出力ファイルを保存
-   出力ファイル名は `output_YYYYMMDDHHmmss.xlsx`
-   `downloads/` をコンテナのボリュームにマウントし、Express で静的配信

### 既存Excelへの追記

-   既存シートに「質問」「回答」列がある場合はそこに追記
-   シート全体を検索して列を検出（最上行だけでなく全セル対象）
-   見つからない場合は新しいシート「回答」を作成

------------------------------------------------------------------------

## インフラ要件

-   Docker Compose 構成
    -   `frontend` サービス: React + Vite 開発環境
    -   `backend` サービス: Express API サーバー
    -   ボリュームマウントして `downloads/` を永続化
-   フロントエンドとバックエンド間は `http://localhost:3001/api`
    経由で通信
